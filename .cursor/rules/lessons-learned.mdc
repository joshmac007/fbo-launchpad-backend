---
description: 
globs: lessons-learned.mdc
alwaysApply: false
---
# Memory Bank Rules: Lessons-learned.mdc

**File Purpose:** This file serves as a cumulative log of key insights, significant learnings, resolved misconceptions, and effective patterns discovered during the project lifecycle. It helps prevent repeating mistakes and reinforces successful approaches for all agents interacting with the project.

**Cursor's Responsibility:**

1.  **Identify Learnings:** During task execution or context review, actively identify situations where:
    *   An initial assumption or approach was incorrect and needed correction (e.g., misunderstanding routing, state management issues).
    *   A particularly effective solution or pattern was implemented.
    *   A subtle requirement or constraint was discovered or clarified.
    *   A significant refactoring occurred due to a previous design flaw.
2.  **Record Concisely:** After completing a task where a notable learning occurred, add a new entry to this file.
    *   Use a clear heading (e.g., date or related feature).
    *   Briefly describe the initial situation or misconception.
    *   Clearly state the resolution or the correct approach discovered.
    *   Summarize the key takeaway or "lesson learned" in a reusable format.
3.  **Categorize (Optional):** If the file grows large, consider adding categories (e.g., `# Backend`, `# Frontend`, `# Testing`, `# Architecture`).
4.  **Reference Context:** When applicable, briefly mention related memory bank files or specific tasks for deeper context, but keep the entry self-contained enough to convey the core lesson.
5.  **Review Regularly:** Briefly scan this file during the initial context review phase of a new task to benefit from past experiences.

**Format:**

*   Use Markdown for readability.
*   Use headings, bullet points, and code formatting where appropriate.
*   Prioritize clarity and conciseness.

**Example Entry:**

```markdown
## Component Replacement Strategy (Frontend - 2024-03-26)

*   **Misconception:** Attempted to add a new Dashboard component alongside the existing one during refactoring.
*   **Resolution:** Realized a complete replacement of the old implementation within `DashboardPage.jsx` was necessary for clarity and to avoid conflicting logic.
*   **Lesson Learned:** When replacing core functionality or components, prioritize a clean cutover rather than running old and new implementations in parallel. Ensure all references are updated. (See `activeContext.md` from that date for details).

## Handling Foreign Key Constraints Proactively (Backend - 2025-05-07)

*   **Initial Situation:** The `FuelOrderService.create_fuel_order` method would raise a `ForeignKeyViolation` if a fuel order was created for a `tail_number` not present in the `aircraft` table.
*   **Resolution:** Modified the service to check for the aircraft's existence. If not found, an `Aircraft` record is automatically created with predefined placeholder values (`aircraft_type="UNKNOWN_TYPE"`, `fuel_type="UNKNOWN_FUEL"`) and added to the same database transaction as the fuel order.
*   **Lesson Learned:** For workflows where dependent entities might not yet exist, consider implementing on-the-fly creation of these entities with sensible defaults/placeholders. This can improve user experience by reducing errors and manual pre-creation steps, provided that there's a subsequent process to update placeholder data. This approach ensures transactional integrity by committing all related records together. (See `docs/technical.md` and `tasks/active_context.md` from 2025-05-07 for details on the specific `ForeignKeyViolation` and its resolution).